<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<meta http-equiv="Content-Script-Type" content="text/javascript" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<title>Interface GTFS</title>
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />
		<script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-polylinedecorator/1.1.0/leaflet.polylineDecorator.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
	</head>
<body>
<p><a href="type_of_pt.html">Home</a>
 - <a href="get_agency_1.html">Métro</a>
 - <a href="get_routes_1_439.html">439</a>
 - <a href="get_trips_1_439_100110007:7_0.html">100110007:7 0</a>
 79584421-184395
</p>
<p><button onclick="get_itin()">Itinéraire</button></p>
<p id="load_josm"></p>
<table id="osm"><tr>
<th><a href="http://localhost:8111/load_data?new_layer=false&data=%3C%3Fxml%20version%3D%271.0%27%20encoding%3D%27UTF-8%27%3F%3E%0A%3Cosm%20version%3D%220.6%22%20upload%3D%22false%22%3E%0A%3Crelation%20id%3D%22-1%22%3E%0A%3Ctag%20k%3D%22type%22%20v%3D%22route%22%2F%3E%0A%3Ctag%20k%3D%22route%22%20v%3D%22bus%22%2F%3E%0A%3Ctag%20k%3D%22public_transport%3Aversion%22%20v%3D%222%22%2F%3E%0A%3Ctag%20k%3D%22name%22%20v%3D%22M%C3%A9tro%207%20%3A%20La%20Courneuve-8-mai-1945%20%E2%86%92%20Villejuif-Louis%20Aragon%22%2F%3E%0A%3Ctag%20k%3D%22from%22%20v%3D%22La%20Courneuve-8-mai-1945%22%2F%3E%0A%3Ctag%20k%3D%22to%22%20v%3D%22Villejuif-Louis%20Aragon%22%2F%3E%0A%3Ctag%20k%3D%22ref%22%20v%3D%227%22%2F%3E%0A%3Ctag%20k%3D%22network%22%20v%3D%22METRO%22%2F%3E%0A%3Ctag%20k%3D%22colour%22%20v%3D%22%23F2A5BD%22%2F%3E%0A%3C%2Frelation%3E%0A%3C%2Fosm%3E%0A" target="hide">Créer la relation route dans JOSM</a> (attention aux doublons)
</th></tr>
<tr><td>name:Métro 7 : La Courneuve-8-mai-1945 → Villejuif-Louis Aragon</td></tr>
<tr><td>from:La Courneuve-8-mai-1945</td></tr>
<tr><td>to:Villejuif-Louis Aragon</td></tr>
<tr><td>network:METRO</td></tr>
<tr><td>ref:7</td></tr>
<tr><td>colour:#F2A5BD</td></tr>
</table>
<iframe name="hide" style="display: None;"></iframe>
<div>
<div style="width: 640px; float: left;">
<table id="stops" class="main">
<tr><th>name</th><th>OSM?</th><th>ajout</th><th>?</th></tr>

<tr>
<td style="background-color:#00FF00";>La Courneuve-8-mai-1945</td>
<td style="background-color:#5CFF00";>La Courneuve 8 Mai 1945 (node similaire à 100%) - distance 37 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.409945&right=2.410545&top=48.920817&bottom=48.920217" onclick="map.fitBounds([[48.920217,2.409945],[48.920817,2.410545]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Fort d'Aubervilliers</td>
<td style="background-color:#42FF00";>Fort d'Aubervilliers (node similaire à 100%) - distance 27 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.403296&right=2.403896&top=48.914359&bottom=48.913759" onclick="map.fitBounds([[48.913759,2.403296],[48.914359,2.403896]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#78FF00";>Aubervilliers Pantin (4 Chemins)</td>
<td style="background-color:#56FF00";>Aubervilliers - Pantin - Quatre Chemins (node similaire à 76%) - distance 35 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.392199&right=2.392799&top=48.904201&bottom=48.903601" onclick="map.fitBounds([[48.903601,2.392199],[48.904201,2.392799]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Porte de la Villette</td>
<td style="background-color:#22FF00";>Porte de la Villette (node similaire à 100%) - distance 15 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.385363&right=2.385963&top=48.897832&bottom=48.897232" onclick="map.fitBounds([[48.897232,2.385363],[48.897832,2.385963]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Corentin-Cariou</td>
<td style="background-color:#08FF00";>Corentin Cariou (node similaire à 100%) - distance 5 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.382021&right=2.382621&top=48.894984&bottom=48.894384" onclick="map.fitBounds([[48.894384,2.382021],[48.894984,2.382621]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Crimée</td>
<td style="background-color:#BEFF00";>Crimée (node similaire à 100%) - distance 75 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.376498&right=2.377098&top=48.890591&bottom=48.889991" onclick="map.fitBounds([[48.889991,2.376498],[48.890591,2.377098]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Riquet</td>
<td style="background-color:#2DFF00";>Riquet (node similaire à 100%) - distance 19 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.374152&right=2.374752&top=48.888696&bottom=48.888096" onclick="map.fitBounds([[48.888096,2.374152],[48.888696,2.374752]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Stalingrad</td>
<td style="background-color:#FFA600";>Stalingrad (node similaire à 100%) - distance 134 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.368589&right=2.369189&top=48.884375&bottom=48.883775" onclick="map.fitBounds([[48.883775,2.368589],[48.884375,2.369189]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Louis Blanc</td>
<td style="background-color:#F5FF00";>Louis Blanc (node similaire à 100%) - distance 96 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.364826&right=2.365426&top=48.881203&bottom=48.880603" onclick="map.fitBounds([[48.880603,2.364826],[48.881203,2.365426]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Château Landon</td>
<td style="background-color:#8DFF00";>Château Landon (node similaire à 100%) - distance 56 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.361773&right=2.362373&top=48.878759&bottom=48.878159" onclick="map.fitBounds([[48.878159,2.361773],[48.878759,2.362373]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#A7FF00";>Gare de l'est (Verdun)</td>
<td style="background-color:#CBFF00";>Gare de l'Est (node similaire à 67%) - distance 80 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.358706&right=2.359306&top=48.87672&bottom=48.87612" onclick="map.fitBounds([[48.87612,2.358706],[48.87672,2.359306]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Poissonnière</td>
<td style="background-color:#20FF00";>Poissonnière (node similaire à 100%) - distance 14 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.3491&right=2.3497&top=48.877656&bottom=48.877056" onclick="map.fitBounds([[48.877056,2.3491],[48.877656,2.3497]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Cadet</td>
<td style="background-color:#B1FF00";>Cadet (node similaire à 100%) - distance 70 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.343064&right=2.343664&top=48.876129&bottom=48.875529" onclick="map.fitBounds([[48.875529,2.343064],[48.876129,2.343664]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Le Peletier</td>
<td style="background-color:#20FF00";>Le Peletier (node similaire à 100%) - distance 14 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.339875&right=2.340475&top=48.875266&bottom=48.874666" onclick="map.fitBounds([[48.874666,2.339875],[48.875266,2.340475]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Chaussée d'Antin (la Fayette)</td>
<td style="background-color:#20FF00";>Chaussée d'Antin - La Fayette (node similaire à 100%) - distance 14 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.333145&right=2.333745&top=48.873289&bottom=48.872689" onclick="map.fitBounds([[48.872689,2.333145],[48.873289,2.333745]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Opéra</td>
<td style="background-color:#2FFF00";>Opéra (node similaire à 100%) - distance 20 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.332273&right=2.332873&top=48.870862&bottom=48.870262" onclick="map.fitBounds([[48.870262,2.332273],[48.870862,2.332873]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Pyramides</td>
<td style="background-color:#DBFF00";>Pyramides (node similaire à 100%) - distance 86 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.333813&right=2.334413&top=48.8668&bottom=48.8662" onclick="map.fitBounds([[48.8662,2.333813],[48.8668,2.334413]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Palais-Royal (Musée du Louvre)</td>
<td style="background-color:#FFB800";>Palais Royal - Musée du Louvre (node similaire à 100%) - distance 127 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.335202&right=2.335802&top=48.86369&bottom=48.86309" onclick="map.fitBounds([[48.86309,2.335202],[48.86369,2.335802]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Pont Neuf</td>
<td style="background-color:#13FF00";>Pont Neuf (node similaire à 100%) - distance 9 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.341836&right=2.342436&top=48.858837&bottom=48.858237" onclick="map.fitBounds([[48.858237,2.341836],[48.858837,2.342436]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Châtelet</td>
<td style="background-color:#FF3B00";>Châtelet (node similaire à 100%) - distance 175 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.346943&right=2.347543&top=48.857506&bottom=48.856906" onclick="map.fitBounds([[48.856906,2.346943],[48.857506,2.347543]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#FFDF00";>Pont Marie (Cité des Arts)</td>
<td style="background-color:#AFFF00";>Pont Marie (node similaire à 44%) - distance 69 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.357103&right=2.357703&top=48.853766&bottom=48.853166" onclick="map.fitBounds([[48.853166,2.357103],[48.853766,2.357703]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Sully-Morland</td>
<td style="background-color:#C6FF00";>Sully - Morland (node similaire à 100%) - distance 78 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.360956&right=2.361556&top=48.851096&bottom=48.850496" onclick="map.fitBounds([[48.850496,2.360956],[48.851096,2.361556]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Jussieu</td>
<td style="background-color:#00FF00";>Jussieu (node similaire à 100%) - distance 2 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.354526&right=2.355126&top=48.846271&bottom=48.845671" onclick="map.fitBounds([[48.845671,2.354526],[48.846271,2.355126]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#FFDF00";>Place Monge (Jardin des Plantes)</td>
<td style="background-color:#4CFF00";>Place Monge (node similaire à 44%) - distance 31 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.351829&right=2.352429&top=48.843467&bottom=48.842867" onclick="map.fitBounds([[48.842867,2.351829],[48.843467,2.352429]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Censier-Daubenton</td>
<td style="background-color:#1DFF00";>Censier - Daubenton (node similaire à 100%) - distance 13 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.351474&right=2.352074&top=48.840897&bottom=48.840297" onclick="map.fitBounds([[48.840297,2.351474],[48.840897,2.352074]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Les Gobelins</td>
<td style="background-color:#B7FF00";>Les Gobelins (node similaire à 100%) - distance 72 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.3518&right=2.3524&top=48.83643&bottom=48.83583" onclick="map.fitBounds([[48.83583,2.3518],[48.83643,2.3524]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Place d'Italie</td>
<td style="background-color:#D8FF00";>Place d'Italie (node similaire à 100%) - distance 85 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.355052&right=2.355652&top=48.831855&bottom=48.831255" onclick="map.fitBounds([[48.831255,2.355052],[48.831855,2.355652]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Tolbiac</td>
<td style="background-color:#3AFF00";>Tolbiac (node similaire à 100%) - distance 24 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.356738&right=2.357338&top=48.826462&bottom=48.825862" onclick="map.fitBounds([[48.825862,2.356738],[48.826462,2.357338]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Maison Blanche</td>
<td style="background-color:#88FF00";>Maison Blanche (node similaire à 100%) - distance 54 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.357798&right=2.358398&top=48.823181&bottom=48.822581" onclick="map.fitBounds([[48.822581,2.357798],[48.823181,2.358398]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Le Kremlin-Bicêtre</td>
<td style="background-color:#47FF00";>Le Kremlin-Bicêtre (node similaire à 100%) - distance 29 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.361549&right=2.362149&top=48.810688&bottom=48.810088" onclick="map.fitBounds([[48.810088,2.361549],[48.810688,2.362149]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Villejuif-léo Lagrange</td>
<td style="background-color:#FF7700";>Villejuif - Léo Lagrange (node similaire à 100%) - distance 152 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.363628&right=2.364228&top=48.804072&bottom=48.803472" onclick="map.fitBounds([[48.803472,2.363628],[48.804072,2.364228]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#A7FF00";>Villejuif-Paul Vaillant Couturier (Hôpital Paul Brousse)</td>
<td style="background-color:#1DFF00";>Villejuif - Paul Vaillant Couturier (node similaire à 67%) - distance 13 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.36795&right=2.36855&top=48.796297&bottom=48.795697" onclick="map.fitBounds([[48.795697,2.36795],[48.796297,2.36855]]);" target="hide">zoom JOSM</a></td>
</tr>
<tr>
<td style="background-color:#00FF00";>Villejuif-Louis Aragon</td>
<td style="background-color:#5EFF00";>Villejuif–Louis Aragon (node similaire à 100%) - distance 38 m
</td>
<td></td>
<td><a href="http://localhost:8111/load_and_zoom?left=2.366829&right=2.367429&top=48.78694&bottom=48.78634" onclick="map.fitBounds([[48.78634,2.366829],[48.78694,2.367429]]);" target="hide">zoom JOSM</a></td>
</tr>
</table>
</div>
<div id="map" style="width: 640px; height: 400px; float: left;">
</div></div>


<script type='text/javascript'> // couche "osmfr" 
var osmfr = L.tileLayer('http://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', 
{
    attribution: 'donn&eacute;es &copy; <a href="http://osm.org/copyright">OpenStreetMap</a>/ODbL - rendu cquest',
    minZoom: 1,
    maxZoom: 20
});
  
// liste des couches de base
var baseMaps = {
    "Rendu FR": osmfr
};
var geojsonFeature ={
  "type":"Feature",
  "geometry": {
	"type":"GeometryCollection",
	"geometries": [
	{"type":"LineString","coordinates":[[2.410245,48.920517],[2.403596,48.914059],[2.392499,48.903901],[2.385663,48.897532],[2.382321,48.894684],[2.376798,48.890291],[2.374452,48.888396],[2.368889,48.884075],[2.365126,48.880903],[2.362073,48.878459],[2.359006,48.87642],[2.3494,48.877356],[2.343364,48.875829],[2.340175,48.874966],[2.333445,48.872989],[2.332573,48.870562],[2.334113,48.8665],[2.335502,48.86339],[2.342136,48.858537],[2.347243,48.857206],[2.357403,48.853466],[2.361256,48.850796],[2.354826,48.845971],[2.352129,48.843167],[2.351774,48.840597],[2.3521,48.83613],[2.355352,48.831555],[2.357038,48.826162],[2.358098,48.822881],[2.361849,48.810388],[2.363928,48.803772],[2.36825,48.795997],[2.367129,48.78664]]},
	{"type":"Point","coordinates":[2.410245,48.920517]}]},

  "properties": {
	"name":"test"
  }
};


map = L.map('map', { center: [47.000,2.000], zoom: 10, layers: [osmfr] } );
json = L.geoJSON(geojsonFeature).addTo(map); 

var myStyle = {
    "color": "#ff7800",
    "weight": 5,
    "opacity": 0.65
};

var nodes = [];
var legs;
var loadurl="http://localhost:8111/load_object?referrers=true&objects=";


function get_itin() {
var geojsonLayer = new L.GeoJSON.AJAX("http://router.project-osrm.org/match/v1/driving/2.410245,48.920517;2.403596,48.914059;2.392499,48.903901;2.385663,48.897532;2.382321,48.894684;2.376798,48.890291;2.374452,48.888396;2.368889,48.884075;2.365126,48.880903;2.362073,48.878459;2.359006,48.87642;2.3494,48.877356;2.343364,48.875829;2.340175,48.874966;2.333445,48.872989;2.332573,48.870562;2.334113,48.8665;2.335502,48.86339;2.342136,48.858537;2.347243,48.857206;2.357403,48.853466;2.361256,48.850796;2.354826,48.845971;2.352129,48.843167;2.351774,48.840597;2.3521,48.83613;2.355352,48.831555;2.357038,48.826162;2.358098,48.822881;2.361849,48.810388;2.363928,48.803772;2.36825,48.795997;2.367129,48.78664?timestamps=1487482500;1487482560;1487482740;1487482860;1487482920;1487482980;1487483040;1487483160;1487483220;1487483340;1487483400;1487483520;1487483580;1487483640;1487483700;1487483820;1487483880;1487483940;1487484060;1487484120;1487484240;1487484300;1487484420;1487484480;1487484600;1487484660;1487484720;1487484840;1487484900;1487485020;1487485080;1487485200;1487485320&radiuses=20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20;20&overview=full&geometries=geojson&generate_hints=false&annotations=true",{
	style:myStyle,
	middleware:function(data){
legs = data.matchings[0].legs;
for(var i in legs) {
nodes.push(legs[i].annotation.nodes);
}

for(i=0; i < nodes.length; i++){
for(j=0; j < nodes[i].length; j++) {
	loadurl += "n" + nodes[i][j] + ",";
}
}

document.getElementById("load_josm").innerHTML = '<a href="'+loadurl+'" target="hide">Load JOSM</a>';

		return data.matchings[0].geometry;
	}
});

geojsonLayer.addTo(map);
};



map.fitBounds(json.getBounds());
jj=json.getLayers()[0]._layers;

idx=Object.keys(jj)[0]

//debugger;
var decorator = L.polylineDecorator(jj[idx]._latlngs, 
{
    patterns: [
            {offset: 25, repeat: 50, symbol: L.Symbol.arrowHead({pixelSize: 15, pathOptions: 
{fillOpacity: 1, weight: 0}})}
        ]
}).addTo(map);

// ajout de l'échelle
L.control.scale().addTo(map);

</script>


</body>
</html>
